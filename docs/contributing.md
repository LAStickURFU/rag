# Руководство по внесению вклада в проект

Благодарим за интерес к проекту RAG-системы! В этом документе описаны основные правила и рекомендации для разработчиков, желающих внести свой вклад в проект.

## Начало работы

### Настройка окружения разработки

1. Клонируйте репозиторий:
   ```bash
   git clone https://your-repository-url.git
   cd rag
   ```

2. Создайте виртуальное окружение:
   ```bash
   python -m venv venv
   source venv/bin/activate  # На Windows: venv\Scripts\activate
   ```

3. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   pip install -r requirements-dev.txt  # Устанавливает дополнительные пакеты для разработки
   ```

4. Установите pre-commit hooks:
   ```bash
   pre-commit install
   ```

### Запуск тестов

Перед отправкой изменений убедитесь, что все тесты проходят успешно:

```bash
pytest
```

Для запуска конкретного модуля тестов:

```bash
pytest tests/test_chunking.py
```

## Рабочий процесс

### Создание ветки

Для работы над новыми функциями или исправлениями создавайте отдельную ветку:

```bash
git checkout -b feature/название-функции
# или
git checkout -b fix/название-исправления
```

### Рекомендации по коммитам

- Используйте информативные сообщения коммитов
- Пишите сообщения в формате: `[компонент]: краткое описание`
- Например: `[chunking]: добавлен семантический метод разбиения`

### Pull Request (PR)

1. Отправьте ветку в репозиторий: `git push origin feature/название-функции`
2. Создайте Pull Request на GitHub
3. Укажите подробное описание изменений
4. Дождитесь проверки CI и код-ревью

## Структура проекта

### Бэкенд

- `app/` - основной код приложения
  - `chunking/` - компоненты для разбиения документов
  - `retrieval/` - компоненты для поиска
  - `routers/` - API-маршруты
  - `rag.py` - основной RAG-сервис
  - `main.py` - точка входа FastAPI

### Фронтенд

- `frontend/` - React-приложение
  - `src/components/` - компоненты интерфейса
  - `src/pages/` - страницы приложения
  - `src/services/` - API-клиенты

### Тесты

- `tests/` - автоматические тесты
  - `test_chunking/` - тесты для модулей чанкинга
  - `test_retrieval/` - тесты для модулей поиска
  - `test_integration/` - интеграционные тесты

## Стандарты кода

### Форматирование

- Используйте [black](https://github.com/psf/black) для форматирования Python-кода:
  ```bash
  black app tests
  ```

- Используйте [isort](https://github.com/pycqa/isort) для организации импортов:
  ```bash
  isort app tests
  ```

### Линтеры

- Используйте [flake8](https://flake8.pycqa.org/) для проверки стиля кода:
  ```bash
  flake8 app tests
  ```

- Используйте [mypy](http://mypy-lang.org/) для проверки типов:
  ```bash
  mypy app
  ```

## Документация

### Документирование кода

- Используйте docstrings в формате Google Style для документирования функций и классов
- Пример:
  ```python
  def function(param1: str, param2: int) -> bool:
      """Краткое описание функции.
      
      Подробное описание функции, при необходимости с несколькими
      строками.
      
      Args:
          param1: Описание первого параметра.
          param2: Описание второго параметра.
          
      Returns:
          Описание возвращаемого значения.
          
      Raises:
          ValueError: Описание исключения.
      """
      # Код функции
  ```

### Документация системы

При изменении функциональности системы, обновите соответствующие документы в директории `docs/`.

## Рекомендации по разработке

### Основные принципы

1. **Модульность** - разделяйте код на логические компоненты
2. **Тестируемость** - пишите код, который легко тестировать
3. **Масштабируемость** - учитывайте возможность масштабирования системы
4. **Документация** - документируйте новую функциональность

### Расширение функциональности

#### Добавление нового метода чанкинга

1. Создайте новый класс в `app/chunking/`
2. Имплементируйте интерфейс, совместимый с `UnifiedChunker`
3. Добавьте регистрацию в `get_chunker()` функцию
4. Напишите тесты в `tests/test_chunking/`
5. Обновите документацию в `docs/architecture.md`

#### Добавление нового метода поиска

1. Создайте новый класс в `app/retrieval/`
2. Интегрируйте его с `RAGService`
3. Обновите интерфейс в `app/routers/chat.py`
4. Напишите тесты
5. Обновите документацию

## Управление выпусками

### Версионирование

Проект использует [семантическое версионирование](https://semver.org/):
- **MAJOR** - несовместимые изменения API
- **MINOR** - добавление новых функций (обратно совместимых)
- **PATCH** - исправления ошибок (обратно совместимых)

### Процесс выпуска

1. Обновите CHANGELOG.md с описанием изменений
2. Обновите версию в соответствующих файлах
3. Создайте тег с новой версией:
   ```bash
   git tag v1.0.0
   git push origin v1.0.0
   ```

## Часто задаваемые вопросы для разработчиков

### Как добавить новую зависимость?

1. Добавьте пакет в requirements.txt или requirements-dev.txt
2. Обновите Dockerfile, если необходимо
3. Обновите инструкции по установке в документации

### Как отладить проблемы с производительностью?

1. Используйте профилирование для Python:
   ```python
   import cProfile
   cProfile.run('функция_для_профилирования()')
   ```

2. Для отладки запросов к Qdrant используйте встроенный мониторинг:
   ```
   http://localhost:6333/dashboard
   ```

### Как решать проблемы с Docker?

Для просмотра логов контейнеров:
```bash
docker-compose logs -f backend
```

Для перезапуска отдельной службы:
```bash
docker-compose restart backend
```

## Контакты

Если у вас есть вопросы или предложения, которые не описаны в этом руководстве:
- Создайте Issue в репозитории
- Обратитесь к основным разработчикам проекта 